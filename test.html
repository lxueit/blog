<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>
        let randomNum = function (len) {
            function _createNum() {
                return (Math.random() * 100 + '').split('.')[0]
            }
            let arr = []
            for (let i = 0; i < len; i++) arr.push(+_createNum())
            return arr
        }

        // var len;    // 因为声明的多个函数都需要数据长度，所以把len设置成为全局变量

        // function buildMaxHeap(arr) {   // 建立大顶堆
        //     len = arr.length;
        //     for (var i = Math.floor(len / 2); i >= 0; i--) {
        //         heapify(arr, i);
        //     }
        // }

        // function heapify(arr, i) {     // 堆调整
        //     var left = 2 * i + 1,
        //         right = 2 * i + 2,
        //         largest = i;

        //     if (left < len && arr[left] > arr[largest]) {
        //         largest = left;
        //     }

        //     if (right < len && arr[right] > arr[largest]) {
        //         largest = right;
        //     }

        //     if (largest != i) {
        //         swap(arr, i, largest);
        //         heapify(arr, largest);
        //     }
        // }

        // function swap(arr, i, j) {
        //     var temp = arr[i];
        //     arr[i] = arr[j];
        //     arr[j] = temp;
        // }

        // function heapSort(arr) {
        //     buildMaxHeap(arr);

        //     for (var i = arr.length - 1; i > 0; i--) {
        //         swap(arr, 0, i);
        //         len--;
        //         heapify(arr, 0);
        //     }
        //     return arr;
        // }


      
        function heapSort(arr) {
                let len = arr.length


                //用于交换两个元素的位置
                function swap(arr, i, j) {
                    //第一种方法
                    // let temp = arr[i]
                    // arr[i] = arr[j]
                    // arr[j] = temp

                    //第二种方法
                    [arr[i], arr[j]] = [arr[j], arr[i]]
                }

                //创建最大堆
                function buildMaxHeap(arr) {
                    let boundary = Math.floor(Math.floor(len / 2 - 1))
                    for (let i = boundary; i >= 0; i--) {
                        heapChange(arr, i)
                    }
                }

                //节点位置调整
                function heapChange(arr, i) {
                    let left = i * 2 + 1
                    let right = i * 2 + 2
                    let largeIndex = i

                    if (left < len && arr[left] > arr[largeIndex]) {
                        largeIndex = left
                    }

                    if (right < len && arr[right] > arr[largeIndex]) {
                        largeIndex = right
                    }

                    if (largeIndex != i) {
                        swap(arr, i, largeIndex)
                        heapChange(arr, largeIndex)
                    }

                }


                buildMaxHeap(arr)
                for (let i = len - 1; i > 0; i--) {
                    swap(arr, 0, i)
                    len--
                    heapChange(arr, 0)
                }

                return arr
            }



        var arr = randomNum(7)

        arr = [12, 41, 71, 56, 43, 12, 41]


        




    </script>
</body>

</html>